export function wgDownload(wgTools, wgTop, mediasLength) {
    // Add Download icon in toolbar
    let downloadTool = document.createElement('a');
    downloadTool.setAttribute('target', '_blank');
    downloadTool.classList.add('downloadTool');
    downloadTool.innerHTML = `<svg width="700pt" height="700pt" version="1.1" viewBox="0 0 700 700" xmlns="http://www.w3.org/2000/svg"><path d="m349.7 0c-10.902 0.17578-19.688 9.0469-19.688 19.984v0.29688-0.015625 351.4l-125.75-125.75c-3.6211-3.6211-8.6094-5.8438-14.121-5.8438-11.043 0-19.984 8.9609-19.984 19.984 0 5.5312 2.2383 10.516 5.8633 14.141l159.86 159.86c0.050782 0.050781 0.14063 0.12109 0.22656 0.19141l0.035156 0.035156c0.19141 0.19141 0.40234 0.38672 0.61328 0.57812l0.015626 0.015625c0.26172 0.24609 0.54297 0.47266 0.82422 0.71875l0.035156 0.035156c0.14063 0.10547 0.33203 0.24609 0.52344 0.38672l0.050781 0.035156c0.26172 0.19141 0.59375 0.4375 0.94531 0.66406l0.085937 0.050781c0.17578 0.12109 0.4375 0.28125 0.71875 0.4375l0.085938 0.050781c0.21094 0.12109 0.50781 0.29688 0.82422 0.45312l0.10547 0.050781c0.15625 0.085938 0.4375 0.22656 0.71875 0.33203l0.12109 0.050781c0.17578 0.085937 0.48828 0.22656 0.80469 0.36719l0.12109 0.050782c0.19141 0.085937 0.54297 0.19141 0.89062 0.31641l0.14062 0.035156c0.14062 0.050782 0.42188 0.15625 0.69922 0.24609l0.14062 0.035156c0.19141 0.050782 0.54297 0.15625 0.89062 0.22656l0.12109 0.015625c0.17578 0.050781 0.50781 0.12109 0.82422 0.17578l0.12109 0.015625c0.19141 0.035156 0.52344 0.085938 0.85938 0.12109l0.10547 0.015625c0.24609 0.035156 0.59375 0.070312 0.94531 0.085937h0.050782c0.31641 0.015625 0.66406 0.035156 1.0312 0.035156h0.015625c0.14062 0 0.31641 0.015626 0.47266 0.015626s0.33203 0 0.50781-0.015626h-0.015626c0.61328-0.015624 1.207-0.050781 1.7852-0.12109l-0.085938 0.015625c0.15625-0.015625 0.19141-0.035156 0.24609-0.035156l-0.12109 0.015624c0.52344-0.070312 0.94531-0.14062 1.3633-0.22656l-0.12109 0.015625c0.45312-0.085937 0.76953-0.15625 1.0859-0.22656l-0.14062 0.035157c0.38672-0.085938 0.64844-0.15625 0.89062-0.22656l-0.14062 0.035156c0.54297-0.15625 0.94531-0.28125 1.3281-0.40234l-0.14062 0.035156c0.38672-0.12109 0.61328-0.22656 0.85938-0.31641l-0.12109 0.050781c0.48828-0.19141 0.83984-0.33203 1.1719-0.50781l-0.12109 0.050781c0.64844-0.29688 1.1367-0.54297 1.6289-0.80469l-0.10547 0.050781c0.085938-0.050781 0.10547-0.070312 0.12109-0.085937l-0.070313 0.050781c0.47266-0.26172 0.83984-0.50781 1.207-0.75391l-0.070313 0.050781c0.33203-0.22656 0.59375-0.38672 0.83984-0.57812l-0.050781 0.035156c0.48828-0.36719 0.91016-0.69922 1.3125-1.0508l-0.015625 0.015625c0.035156-0.035156 0.085937-0.085937 0.12109-0.12109 0.33203-0.28125 0.64844-0.54297 0.92578-0.82422l159.84-159.84c3.7461-3.6406 6.0547-8.7148 6.0547-14.332 0-11.043-8.9414-19.984-19.984-19.984-0.21094 0-0.40234 0-0.61328 0.015624h0.035156c-5.3906 0.15625-10.238 2.4336-13.738 6.0195l-125.74 125.75v-351.4-0.26172c0-11.043-8.9414-19.984-19.984-19.984h-0.31641 0.015624zm-259.47 519.8h-0.28125c-11.043 0-19.984 8.9414-19.984 19.984 0 11.043 8.9609 19.984 19.984 19.984h0.29688 519.5 0.28125c11.043 0 19.984-8.9414 19.984-19.984 0-11.043-8.9414-19.984-19.984-19.984h-0.29688z" style="fill:#fff"/></svg>`;
    wgTools.appendChild(downloadTool);

    // Handle event click
    downloadTool.addEventListener('click', (event) => {
        downloadTool.removeAttribute('download');
        downloadTool.setAttribute('href', '');

        let currentSlides = [];

        switch (wgTop.activeIndex - 1) {
            case 0:
            case mediasLength:
                currentSlides = document.querySelectorAll(`.wg-swiper-top .swiper-slide[data-swiper-slide-index="0"]`);
                break;

            case mediasLength - 1:
            case -1:
                currentSlides = document.querySelectorAll(`.wg-swiper-top .swiper-slide[data-swiper-slide-index="${mediasLength - 1}"]`);
                break;

            default:
                currentSlides = document.querySelectorAll(`.wg-swiper-top .swiper-slide[data-swiper-slide-index="${wgTop.activeIndex -1}"]`);
                break;
        }

        let currentImgSrc = currentSlides[0].getAttribute('data-wgsrc');

        if (currentImgSrc != undefined) {
            downloadTool.setAttribute('download', '');
            downloadTool.setAttribute('href', currentImgSrc);
        } else {
            event.preventDefault();
        }
    });
};
